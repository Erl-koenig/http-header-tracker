<!doctype html>
<html>
    <head>
        <title>HTTP Header Tracker Settings</title>
        <link rel="stylesheet" href="settings.css" />
    </head>
    <body>
        <div class="container">
            <h1>HTTP Header Tracker Settings</h1>

            <div class="settings-section">
                <h2>Collection Mode</h2>
                <p class="description">
                    Choose how you want to store your collected header
                    statistics.
                </p>

                <div class="info-box">
                    <strong>Local-Only Mode (Default)</strong>
                    <p>
                        Leave the server URL empty to store all data locally in
                        your browser. Data accumulates until you manually clear
                        it. Use the "Export" button in the popup to download
                        your data as JSON.
                    </p>
                    <strong>Server Mode</strong>
                    <p>
                        Enter a server URL below to automatically upload
                        aggregated stats to your server. Local data is cleared
                        after each successful upload, so the server becomes your
                        data store.
                    </p>
                </div>

                <label for="serverEndpoint">Server URL (Optional):</label>
                <input
                    type="url"
                    id="serverEndpoint"
                    placeholder="https://your-server.com/plugin"
                    class="input-field"
                />
                <div class="button-row">
                    <button id="saveBtn" class="btn btn-primary">
                        Save Settings
                    </button>
                    <button id="testBtn" class="btn btn-secondary">
                        Test Connection
                    </button>
                </div>
                <div id="statusMsg" class="status-message"></div>
            </div>

            <div class="settings-section" id="frequencySection">
                <h2>Save & Upload Frequency</h2>
                <p class="description">
                    How often to save captured headers from memory to local
                    storage. In server mode, this also controls upload
                    frequency.
                </p>

                <label for="uploadFrequency">Sync every:</label>
                <select id="uploadFrequency" class="input-field">
                    <option value="1">1 minute</option>
                    <option value="5" selected>5 minutes</option>
                    <option value="15">15 minutes</option>
                </select>
                <div class="button-row">
                    <button id="saveFrequencyBtn" class="btn btn-primary">
                        Save Frequency
                    </button>
                    <div id="frequencyStatus" class="status-message"></div>
                </div>
            </div>

            <div class="settings-section">
                <h2>Data Management</h2>
                <p class="description">
                    Manage your locally stored header statistics.
                </p>

                <div class="info-box">
                    <p>
                        <strong>Total Stats:</strong>
                        <span id="totalStats">Loading...</span>
                    </p>
                    <p class="description">
                        Clearing data will delete all locally stored header
                        statistics. This action cannot be undone.
                    </p>
                    <p class="description warning-text">
                        <strong>Local-Only Mode:</strong> All your data is
                        stored locally. Clear when you want to start fresh.
                    </p>
                    <p class="description warning-text">
                        <strong>Server Mode:</strong> Local data is
                        automatically cleared after each upload. Your data is
                        stored on the server.
                    </p>
                </div>

                <div class="button-row">
                    <button id="clearDataBtn" class="btn btn-danger">
                        Clear All Data
                    </button>
                </div>
                <div id="clearStatus" class="status-message"></div>
            </div>

            <div class="settings-section">
                <h2>About</h2>
                <p>
                    HTTP Header Tracker collects anonymized HTTP header
                    statistics.
                </p>
                <p><strong>Version:</strong> 1.0<br /></p>
                <p>
                    <a
                        href="https://gist.github.com/Erl-koenig/63b2497a55eb1250a1f66cbf1f105bca"
                        target="_blank"
                        >Read our Privacy Policy</a
                    >
                </p>
            </div>
        </div>

        <script src="browser-polyfill.js"></script>
        <script src="settings.js"></script>
    </body>
</html>
